<!DOCTYPE html>
<html lang="en-US">
<head>
	
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/Hardware-Production/css/main.css">
	
</head>
  <body>
    <div class="container-lg px-3 my-5 markdown-body">
      
      <h1><a href="https://darrenprong.github.io/Hardware-Production/">TEA5767 FM Radio</a></h1>
      
<!-- 
Introduction
This blog lists all the steps I took throughout the year 2018 in completing an FM Radio Receiver. 
I will be using the Raspberry PI 3b+ in conjunction with a TEA5767 I2C device. 
-->
	        
        <h4>Darren Prong</h4>
        <h4>N00678964</h4>
        <h4>GitHub: https://github.com/DarrenProng/Hardware-Production</h4>
	   
	 <!-- -->
<head>
<h2>Week 15 (Dec.11th)</h2> 
</head>       
	     
         <!-- -->	      
<head>	    
 <h2>Week 14 (Dec.4th)</h2> 
</head>
	    <p>
		Had to finish up this week as my final presentation was due at the end of class. I pushed through
		some other assignments I had to complete, so I could then rush into the prototype lab for help
		in completing the radio. Heres a video of how the final prototype functions.
	    </p>
	    
<video height="400" width="800" controls> 
	<source src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/WorkingDemo_TEA5767.mp4" type="video/mp4">
</video> 
	    <p>
		    
	    </p>
	    
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/workingSetup.jpg" height="400" width="800">	    
	    
         <!-- -->
<head>	    	    
 <h2>Week 13 (Nov.27th)</h2> 	
	<p>
		This week I designed and printed a enclosure meant to house my PCB/device which is attached to 
		the PI via a 40pin stackable header. It was looking promising until I actually placed
		the PCB inside. Heres a pic:
	</p>	
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/Enclosure_Prototype.jpg" height="400" width="800">
	<p>
		The cutouts for the middle plate are slightly off kilter, as well, the USB ports are pushing up on the
		plate. My idea here was to support the PCB with the piece of acryillic (with standoffs of course).
		
		Tape measure for scale, heres a better picture of my mistake.
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/MiddlePlate.jpg" height="400" width="800">
	<p>
		I tweaked the drawing in CorelDraw so the cutouts are about 3mm higher for the side plate.
		
		The opposite side plate has only one cutout for the on tab on the middle plate. No need
		to adjust that cutout, however, I had flipped the outline which messed up alignment. 
		Ill need to reprint that side. I had to omit the far end tab to accommodate the 40 pin header.
		
		The square cutout (closest to the tape measure) isn't necessary, however, it does 
		make for better passive cooling or some extra space for my soldered pins to float in. 
	</p>
</head>
          <!--Fried PI and Resolution-->		    
<head>            
<h2>Week 12 (Nov.20th)</h2> 	
	<p>
		My working setup in lab...
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/20181120_174603.jpg" height="400" width="800">
	<p>
		Unfortunately, I destroyed my raspberry PI with the newly soldered PCB/device combo. The problem
		turned out to be my incorrect tracing to ground. When trying to test where the problem originated
		I ended up connecting 3-5V to the GPIO pin7, frying this board for good.
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/TEA5767_fritz_pcb.png" height="400" width="600">
	<p>
		Luckily, I was able to transfer my SD card with my files and configuration over to a spare
		PI the parts crib lent me.
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/CurrentSetup.jpg" height="400" width="800">
	<p>
		So the moral of my story is, double check all your connections before hooking up power, no 
		matter how sure you are.
	</p>
	<p>
		I began testing my sensor in the lab this week, with some strange results.
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/PythonFailure_ScreenCap.jpg" height="400" width="800">
	<p>
		Im able to detect the sensor via i2cdetect (address 0x60) however, when I tried to run 
		TEA5767stationscanner.py the Python shell throws an import error. Ive been trying to resolve this issue
		with manually updating my python version and its available libraries. With no luck so far.
		I got the code off LinuxCircle/TEA5767 (on github) which has little info on running the code other than 
		what can be seen here in the comment header. It also lists some further references, which ill be heading 
		to for more instructions and info. 
	</p>
</head>

	<!--Testing sensor with PI-->	
<head>		
<h2>Week 11 (Nov. 13th)</h2> 	
	
	<p>
		I got most of my parts together and heres them assembled and detected.
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/StackableHeader_RaspberryPI.jpg" height="400" width="600">	
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/i2cdetect.jpg" height="400" width="600">

	<p>
		im still using the standard case to protect my PI. This case is too small to fit both the PI and the
		PCB/device, so ill have to modify these files to accomodate both.
	</p>	    	    

</head>
	
<head>
<h2>Week 10 (Nov. 6th)</h2>
	
</head>
  	<!--Soldering new sensor onto PCB-->
<head>
<h2>Week 9 (Oct.30th)</h2>
	<p>
		I just received my sensor this week. Would have never arrived if it wasn't for a classmate who had
		done this class already. He pointed out a great US based website "oddwires.com" which shipped it
		to me in no time. Next time, don't cheap out on chinese products!
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/ShippingPackage.jpg" height="400" width="600">	
	<p>
		I then asked Vlad in the prototype lab for some help in soldering this onto my PCB.
		These are the first soldered connections I've ever made.
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/FirstConnections_toplayer.jpg" height="400" width="600">
	<p>
		I then moved onto soldering the rest of the jumper wires, and the via's, as well as my two screw terminals
		for audio Left and audio Right.
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/TEA5767_soldered.jpg" height="400" width="600">
	<p>
		As I had these finished fairly quickly, I measured it up against my PI to see how they would
		mate-up, and was reminded by a classmate about the stackable headers that were available
		in the prototype lab. So I grabbed a 40-pin header from the lab and soldered one on.
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/BottomLayer.jpg" height="400" width="600">
	<p>
		Unfortunately, the lab had closed up by this point, so ill have to wait till next week to plug it into my PI.
	</p>
</head> 
		
	<!--Enterprise Wi-Fi-->
<head>   
<h2>Week 8 (Oct. 23rd)</h2>
	<p>
		My sensor has yet to show up, however I decided to prepare my PI before it gets here.
		My first requirement was to flash an SD card with raspian-stretch (version.x.x), and get it 
		booted up and ready to go.
	</p>
<!--Which raspian version and where to get it-->
<!-- <img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/.png"> -->
	<p>
		I ended up with a raspberry PI that couldn't boot, and fear immediately set in that my
		little computer was Dead on Arrival. All that would display in my monitor was a 
		small lightning bolt in the top right corner beside a "color correction" screen. Kristian 
		(our instructor) informed me that that icon is usually displayed when the PI has recieved
		insufficent power for the particular power adapter. So we tested a few different power 
		supplies from the parts crib, with no luck unfortunately.
	</p> 
<!--Which power supply to use with 3b+ -->
<!-- <img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/.png"> -->
	<p>
		Later that night I messaged the retailer with my issue along with a plea for any additional help.
		I got a response the next day with a question as to which displays, which power supplies I used 
		and some new info on my particular raspberry PI.
	</p>
<!-- tech support conversation-->
<!-- <img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/.png"> -->
	<p>
		After I responded with the corresponding information, their tech support employee pointed out 
		that the issue could also have been due to an improper flashing of my SD card. I used 
		Win32DiskImager at first, but rushed through the instructions and messed them up obviously.
		The technician recommended Etcher, I'd never heard of this tool. Its install, and basic UI, 
		and usage made it hard to mess up. Which I didnt, this time.
	</p>
<!--Etchers UI-->
<!-- <img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/.png"> -->
	<p>
		After I flashed the OS onto the card and plugged it in, the Pi booted up...yay!
	</p>
<!--raspian boot page-->
<!-- <img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/.png"> -->
</head>
	<p>
		So for the first thing to setup was Enterprise wifi. I went onto our course website and downloaded
		the necessary certificate and copied over the setup instructions into my readme. <!-- something i need to remember to include-->
		As with most of these steps, I recieved a lot of help for the two gentlemen in the Prototype lab.
		Here are some of the instructions I followed:
	</p>
<!--Exact steps from the instructions I followed and why-->
<!-- <img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/.png"> -->
	<p>
		
	</p>

 	<!--Selecting and ordering components-->
 <head>
 <h2>Week 7 (Oct. 16th)</h2>
 </head>
		<p>
		The speakers at the time of ordering werent available;
		solder turned out not to be needed,
		I dont need a soundcard,
		nor a dual channel amplifier.
		I added them in anyways as it could give me opitons later on down the road if I want to upgrade.
		I also have a spare set of tweeters floating around my apartment that I could use instead.
		The PI b+, the Class D amplifier, and the TEA5767 was all purchased on the 16th.
		</p>
	<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/invoice_raspberry_amp.png">
				
<head> 
	
	<!--Fritzing and PCB design-->
  <h2>Week 6 (Oct. 9th)</h2>
  </head>
  <h1>STUDY DAY</h1>
	<p>
		On our week off for this class I came into the prototype lab to start designing my PCB; on which
		my TEA5767 will be mounted. I started messing around with the software, but was also working on 
		finding some other examples online of a completed device. I was hoping to build a more complex 
		version of the device im currently working on, but at the time I realized that a simple FM 
		reciever was the most cost and time-effective way to complete this project. Cost being a 
		significant limiting factor in my situation this semester.
	</p>
<!--full budget ? and some other examples of TEA5767 devices and circuits and usages-->
<!-- <img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/.png"> -->
	<p>
		It wasn't until one to one and a half weeks later that I returned to designing my PCB
		using Fritzing. I'm going to post my progress for that here in order to keep things 
		consistent. I went through a few different iterations of this design, but heres how
		it ended up being designed:
	</p>
<!--The normal unedited fitzing diagram-->
<!-- <img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/.png"> -->
	<p>
		Unfortunately, I made a critical error in this design, which I didnt catch. Even after
		I had redone this design half a dozen times. My traces to the GND pin in this diagram:
	</p>
<!--Edited Fritzing diagram showing which pin is in the wrong location-->
<!-- <img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/.png"> -->
	<p>
		are actually offset by one pin. I wish I had caught this, as when I try to troubleshoot in a few weeks
		as to why the device isnt being detected, ill short out the PI for good.
	</p>
		
	<!--Electronic Design Files -->	    
<head> 
<h2>Week 5 (Oct. 2nd)</h2>
</head>
	<p>
	This is a list of pins associated with my sensor
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/tea5767_pinout.png" >
	<p>
	This is how i'll be connecting them to my Raspberry PI 
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/pinout_TEA5767module.png" width="400" height="800"> 
	
	<p>
		This is an example I found online of the TEA5767 in use.
		In this particular case, they're using a custom PCB to connect a few different
		devices to the Raspberry PI. The end goal for this enginneer was to be able to tune,
		select, play/pause, FM radio stations with an audio amplifier. Routing 2 
		external speakers to a random amplifier (couldn't find this one online) for audio. 
		A USB hub, to extend the PI's functionality with a Wifi dongle and 
		a Microphone to pick up the voice commands.
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/cabling.png" >
	<p>
		A picture of the prototype they developed:
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/radiomodulePCB.png" >
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/radiomodulePCB_back.png" >
	<p>
		A little too complex for me but the design supplied some good ideas
		for my own project.
	</p>
<img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/PCB.png"> 
	<p>
		I've never used any fritzing software, but this looks like a good reference to come
		back to when I start designing mine. They have all the traces on the underside of the
		PCB. Im not sure if ill have to have them on both sides, it depends on the surface mounts 
		I decide on using.
	</p>

	<!-- Submitted Project Budget & Specifications-->
<head> 
<h2>Week 4 (Sept. 25th)</h2>
</head>
	   	  
 <p>
	 Heres a list of my parts to be ordered:
 </p>
  	
  <img src="https://raw.githubusercontent.com/DarrenProng/Hardware-Production/master/images/PartsList.png">
	  
	<!--Submitted Project Schedule-->
<head> 	  
<h2>Week 3 (Sept. 18th)</h2>
</head>
 
	<!--Submitted Project Proposal-->
<head> 
<h2>Week 2 (Sept. 11th)</h2>
</head>

	<!--Blinking light on a raspberry pi -->
<head>
<h2>Week 1 (Tuesday Sept. 4th)</h2>
</head>
        
      <div class="footer border-top border-gray-light mt-5 pt-3 text-right text-gray">
      <a href=""></a>.
      </div>
      
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
    
  </body>
</html>
